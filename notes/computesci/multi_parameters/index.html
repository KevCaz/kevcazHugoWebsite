<!doctype html><html lang=en-us><head><title>KevCaz's Website</title><link rel=stylesheet href=https://kevcaz.github.io/css/main.min.3e80b0b98262c741b43d007658694cef81a3cfc7dbbc04ceb03844577b3a225c.css media=screen><link rel=stylesheet href=../../../css/perso.css><link rel=stylesheet href=../../../css/family.css><meta name=author content="Kevin Cazelles"><meta name=institution content="Department of Integrated Biology, University of Guelph"><meta name=news_keywords content="[Advances Research Computing High Performance Computing Slurm bash Julia]"><meta property="og:site_name" content="KevCaz's Website"><meta property="og:title" content="Running parallel simulations with scripts that take two or more varying parameters"><meta property="og:image" content="https://kevcaz.github.io/img/imgOG/kevcaz_og.png"><meta property="og:description" content="Kevin Cazelles's website"></head><body><div class=page><div class=ctn-sidebar-primary><div class=ctt-sidebar-primary><h1>KevCaz's Website</h1><div class=primary-sidebar-premenu><h2><i class="fas fa-align-center"></i><button onclick="dropDown('p-s-menu')"> Menu</button></h2></div><div class=primary-sidebar-menu id=p-s-menu><h2><a href=../../../><i class="fas fa-home"></i>Home</a></h2><h2><a href=../../../about/><i class="fas fa-id-card"></i>About</a></h2><h2><a onclick="dropDown('dropdown-research')" href=javascript:void(0)><i class="fas fa-microscope"></i>Research</a></h2><div class=dropdown id=dropdown-research><h3><a href=../../../projects/>Projects</a></h3><h3><a href=../../../publications/>Publications</a></h3><h3><a href=../../../software/>Software</a></h3><h3><a href=../../../talks/>Talks & Posters</a></h3><h3><a href=../../../teaching/>Teaching</a></h3><h3><a href=../../../resume/>Resume</a></h3></div><h2 id=current-dropdown><a onclick="dropDown('dropdown-blog')" href=javascript:void(0)><i class="fas fa-blog"></i>Blog</a></h2><div class=dropdown-current id=dropdown-blog><h3><a href=../../../econotes/>EcoNotes</a></h3><h3 id=current><a href=../../../notes/>SilicoNotes</a></h3><h3><a href=https://insileco.github.io/>inSileco</a></h3></div><h2><a onclick="dropDown('dropdown-perso')" href=javascript:void(0)><i class="fas fa-person-booth"></i>Personal stuff</a></h2><div class=dropdown id=dropdown-perso><h3><a href=../../../perso/books>Books I read and liked</a></h3><h3><a href=../../../perso/movies>Movies I watched and liked</a></h3><h3><a href=../../../perso/opinions>Opinions I dare to share</a></h3><h3><a href=../../../perso/famille>Even more personal</a></h3></div></div><div class=footer><hr id=hr-footer align=left><div class=social-media-banner><a href=https://github.com/KevCaz><i class="fab fab fa-github-square"></i></a><a href=https://stackoverflow.com/users/8038778><i class="fab fa-stack-overflow"></i></a><a href=https://twitter.com/KCazelles><i class="fab fa-twitter-square"></i></a><a href=http://orcid.org/0000-0001-6619-9874><i class="ai ai-orcid-square"></i></a><a href="https://scholar.google.ca/citations?user=xzvcu7cAAAAJ%26hl"><i class="ai ai-google-scholar-square"></i></a><a href=https://www.researchgate.net/profile/Kevin_Cazelles><i class="ai ai-researchgate-square"></i></a><a href=https://kevcaz.github.io/index.xml><i class="fas fa-rss-square"></i></a></div><div class=footer-custom>Website built with <a href=https://gohugo.io/>Hugo</a>.<br><i class="fas fa-code"></i>available on <a href=https://github.com/KevCaz/KevCaz.github.io><i class="fab fa-github"></i></a>.<br>Content under <a href=https://creativecommons.org/publicdomain/zero/1.0><i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-zero"></i></a>unless otherwise specified.</div></div></div></div><div class=ctn-main-content><div class=ctt-main-content><div class=article-meta><h1 id=title>Running parallel simulations with scripts that take two or more varying parameters</h1><h3 class=date>August 20, 2020<div class=tags><i class="fas fa-tags" aria-hidden=true></i>&nbsp;
<a href=../../../tags/advances-research-computing><kbd class=item-tag>Advances Research Computing</kbd></a>
<a href=../../../tags/high-performance-computing><kbd class=item-tag>High Performance Computing</kbd></a>
<a href=../../../tags/slurm><kbd class=item-tag>Slurm</kbd></a>
<a href=../../../tags/bash><kbd class=item-tag>bash</kbd></a>
<a href=../../../tags/julia><kbd class=item-tag>Julia</kbd></a></div></div><div class=article-main><p>Another note about how I work with <a href=https://slurm.schedmd.com>Slurm</a>! Today, I
comment on three strategies to run simulations for which the values taken by two
arguments (or more) vary from one simulation to another.</p><h2 id=the-problem>The problem</h2><p>Let's assume that we run simulations by calling a
<a href=https://julialang.org/>Julia</a> script <code>myscript.jl</code> that takes <code>p1</code> as
argument, in order to run the simulation on one
<a href=https://en.wikipedia.org/wiki/Central_processing_unit>CPU</a> for a single
simulation, I would run the following bas command</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>julia -p <span style=color:#bd93f9>1</span> myscript.jl p1
</code></pre></td></tr></table></div></div><p>where I would replace <code>p1</code> by the right value. To run more than one simulation,
say 3 for the sake of example, with Slurm I would write a short bash script and use a <a href=https://slurm.schedmd.com/job_array.html>job array</a> (see
more details in <a href=../arrayjob>this note</a>) be it for simple sequence, e.g.<code>1:3</code>,</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#ff79c6>#!/bin/bash
</span><span style=color:#ff79c6></span><span style=color:#6272a4>#SBATCH --account=def-someone</span>
<span style=color:#6272a4>#SBATCH --time=2:00:00</span>
<span style=color:#6272a4>#SBATCH --cpus-per-task=1</span>
<span style=color:#6272a4>#SBATCH --mem-per-cpu=4G</span>
<span style=color:#6272a4>#SBATCH --array=1-3</span>
<span style=color:#6272a4>#SBATCH --mail-user=kcazelle@uoguelph.ca</span>
<span style=color:#6272a4>#SBATCH --mail-type=FAIL</span>

julia -p <span style=color:#bd93f9>1</span> myscript.jl <span style=color:#8be9fd;font-style:italic>$SLURM_ARRAY_TASK_ID</span>
</code></pre></td></tr></table></div></div><p>or for any set of IDs, e.g. <code>1, 5, 6</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#ff79c6>#!/bin/bash
</span><span style=color:#ff79c6></span><span style=color:#6272a4>#SBATCH --account=def-someone</span>
<span style=color:#6272a4>#SBATCH --time=2:00:00</span>
<span style=color:#6272a4>#SBATCH --cpus-per-task=1</span>
<span style=color:#6272a4>#SBATCH --mem-per-cpu=4G</span>
<span style=color:#6272a4>#SBATCH --array=1,5-6</span>
<span style=color:#6272a4>#SBATCH --mail-user=kcazelle@uoguelph.ca</span>
<span style=color:#6272a4>#SBATCH --mail-type=FAIL</span>

julia -p <span style=color:#bd93f9>1</span> myscript.jl <span style=color:#8be9fd;font-style:italic>$SLURM_ARRAY_TASK_ID</span>
</code></pre></td></tr></table></div></div><p>Now let's assume <code>myscript.jl</code> takes not one but <strong>two parameters</strong>, namely <code>p1</code> and <code>p2</code>, the bash command becomes</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>julia -p <span style=color:#bd93f9>1</span> myscript.jl p1 p2
</code></pre></td></tr></table></div></div><p>I further assume that <code>p1</code> takes the <code>1, 5, 6</code> and <code>p2</code> takes <code>1:5</code> and that I
am interested in running simulations for all combinations (15 simulations in
total). There are various strategies to deal with this scenario and below I
discuss three of such strategies.</p><h2 id=using-gnu-parallel>Using GNU parallelÂ </h2><p>One way is to work with <a href=https://www.gnu.org/software/parallel/>GNU
parallel</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> which could also be
combined with Slurm job array designed (see <a href=../slurmandgnuparallel>this previous
note</a>). Basically, one needs to allocate the right
number of CPU and to use <code>parallel</code> properly. For the example described above, I
could use Slurm array job for <code>p1</code> and <code>parallel</code> for <code>p2</code> (and conversely).</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#ff79c6>#!/bin/bash
</span><span style=color:#ff79c6></span><span style=color:#6272a4>#SBATCH --time=2:00:00</span>
<span style=color:#6272a4>#SBATCH --array=1,5:6</span>
<span style=color:#6272a4>#SBATCH --ntasks-per-node=1</span>
<span style=color:#6272a4>#SBATCH --cpus-per-task=5</span>
<span style=color:#6272a4>#SBATCH --mem-per-cpu=4G</span>
<span style=color:#6272a4>#SBATCH --account=def-ksmccann</span>
<span style=color:#6272a4>#SBATCH --mail-user=kcazelle@uoguelph.ca</span>
<span style=color:#6272a4>#SBATCH --mail-type=FAIL</span>

parallel --delay <span style=color:#bd93f9>2</span> julia -p <span style=color:#bd93f9>1</span> myscript.jl <span style=color:#8be9fd;font-style:italic>$SLURM_ARRAY_TASK_ID</span> <span style=color:#ff79c6>{</span>1<span style=color:#ff79c6>}</span> ::: <span style=color:#ff79c6>{</span>1..5<span style=color:#ff79c6>}</span>
</code></pre></td></tr></table></div></div><p>Note <code>#SBATCH --cpus-per-task=5</code> allocates 5 CPUs per job (1, 5 and
6, so 15 CPUs total). Also, <code>--delay 2</code> is used to avoid <a href=https://en.wikipedia.org/wiki/Thundering_herd_problem>thundering herd
problem</a> (see the
<a href=https://www.gnu.org/software/parallel/parallel_tutorial.html>documentation</a>). Note that I can use parallel for any extra parameters, for instance, assuming there is a third parameter that takes <code>10, 22, 51, 100</code>, I would write</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#ff79c6>#!/bin/bash
</span><span style=color:#ff79c6></span><span style=color:#6272a4>#SBATCH --time=2:00:00</span>
<span style=color:#6272a4>#SBATCH --array=1,5:6</span>
<span style=color:#6272a4>#SBATCH --ntasks-per-node=1</span>
<span style=color:#6272a4>#SBATCH --cpus-per-task=20</span>
<span style=color:#6272a4>#SBATCH --mem-per-cpu=4G</span>
<span style=color:#6272a4>#SBATCH --account=def-ksmccann</span>
<span style=color:#6272a4>#SBATCH --mail-user=kcazelle@uoguelph.ca</span>
<span style=color:#6272a4>#SBATCH --mail-type=FAIL</span>

parallel --delay <span style=color:#bd93f9>2</span> julia -p <span style=color:#bd93f9>1</span> myscript.jl <span style=color:#8be9fd;font-style:italic>$SLURM_ARRAY_TASK_ID</span> <span style=color:#ff79c6>{</span>1<span style=color:#ff79c6>}</span> <span style=color:#ff79c6>{</span>2<span style=color:#ff79c6>}</span> ::: <span style=color:#ff79c6>{</span>1..5<span style=color:#ff79c6>}</span> ::: <span style=color:#bd93f9>10</span> <span style=color:#bd93f9>22</span> <span style=color:#bd93f9>51</span> <span style=color:#bd93f9>100</span>
</code></pre></td></tr></table></div></div><p>Actually, one can stick to <code>parallel</code> and ignore Slurm job array but it is
slightly more complicated when one needs to deal with more than one node,
although it is totally doable and well-explained on <a href=https://docs.computecanada.ca/wiki/GNU_Parallel>Compute Canada's
Wiki</a>.</p><h2 id=additional-bash-lines>Additional bash lines</h2><p>A strategy I recently used to write additional bash lines to make two bash
variables out of <code>$SLURM_ARRAY_TASK_ID</code>. For the example we are discussing, I
would write the following bash script</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#ff79c6>#!/bin/bash
</span><span style=color:#ff79c6></span><span style=color:#6272a4>#SBATCH --time=2:00:00</span>
<span style=color:#6272a4>#SBATCH --array=1-15</span>
<span style=color:#6272a4>#SBATCH --ntasks-per-node=1</span>
<span style=color:#6272a4>#SBATCH --cpus-per-task=1</span>
<span style=color:#6272a4>#SBATCH --mem-per-cpu=4G</span>
<span style=color:#6272a4>#SBATCH --account=def-ksmccann</span>
<span style=color:#6272a4>#SBATCH --mail-user=kcazelle@uoguelph.ca</span>
<span style=color:#6272a4>#SBATCH --mail-type=FAIL</span>

<span style=color:#8be9fd;font-style:italic>vals</span><span style=color:#ff79c6>=</span><span style=color:#ff79c6>(</span><span style=color:#bd93f9>1</span> <span style=color:#bd93f9>5</span> 6<span style=color:#ff79c6>)</span>
<span style=color:#8be9fd;font-style:italic>p1</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>${</span><span style=color:#8be9fd;font-style:italic>vals</span>[@]:(((<span style=color:#8be9fd;font-style:italic>$SLURM_ARRAY_TASK_ID</span> - 1) / 5)):<span style=color:#8be9fd;font-style:italic>1</span><span style=color:#f1fa8c>}</span>
<span style=color:#8be9fd;font-style:italic>p2</span><span style=color:#ff79c6>=</span><span style=color:#ff79c6>$((</span><span style=color:#ff79c6>(</span><span style=color:#8be9fd;font-style:italic>$SLURM_ARRAY_TASK_ID</span> <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span><span style=color:#ff79c6>)</span> <span style=color:#ff79c6>%</span> <span style=color:#bd93f9>5</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span><span style=color:#ff79c6>))</span>

julia -p <span style=color:#bd93f9>1</span> myscript.jl <span style=color:#8be9fd;font-style:italic>$p1</span> <span style=color:#8be9fd;font-style:italic>$p2</span>
</code></pre></td></tr></table></div></div><p>Note that above I introduce one <a href=https://www.linuxjournal.com/content/bash-arrays>bash
array</a> and
<code>${vals[@]:((($SLURM_ARRAY_TASK_ID - 1) / 5)):1}</code> is used to extract <code>1</code> element
starting at <code>(($SLURM_ARRAY_TASK_ID - 1) / 5))</code> (note that index starts at 0 for
bash arrays). This may be very helpful for people that are already confortable
with bash scripts.</p><h2 id=stick-to-one-parameter-and-deal-with-it-directly-in-your-script>Stick to one parameter and deal with it directly in your script!</h2><p>Last but not least, I can stick to one parameter and make it two, directly in my
script. This is more a way around than a solution of the problem we described
earlier, but this may very well be the easiest solution in many cases as it simply requires to add extra lines in the programming langage the script was coded in. Here I would add the following lines in <code>myscript.jl</code></p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia>p0<span style=color:#ff79c6></span> <span style=color:#ff79c6>=</span> parse<span style=color:#ff79c6></span>(<span style=color:#8be9fd>Int</span>, <span style=color:#8be9fd;font-style:italic>ARGS</span>[<span style=color:#bd93f9>1</span>]) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>
p1<span style=color:#ff79c6></span> <span style=color:#ff79c6>=</span> [<span style=color:#bd93f9>1</span> <span style=color:#bd93f9>5</span> <span style=color:#bd93f9>6</span>][div<span style=color:#ff79c6></span>(p0<span style=color:#ff79c6></span>, <span style=color:#bd93f9>5</span>) <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>]
p2<span style=color:#ff79c6></span> <span style=color:#ff79c6>=</span> p0<span style=color:#ff79c6></span> <span style=color:#ff79c6>%</span> <span style=color:#bd93f9>5</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>
</code></pre></td></tr></table></div></div><p>and then simply declare 15 jobs:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#ff79c6>#!/bin/bash
</span><span style=color:#ff79c6></span><span style=color:#6272a4>#SBATCH --time=2:00:00</span>
<span style=color:#6272a4>#SBATCH --array=1-15</span>
<span style=color:#6272a4>#SBATCH --ntasks-per-node=1</span>
<span style=color:#6272a4>#SBATCH --cpus-per-task=1</span>
<span style=color:#6272a4>#SBATCH --mem-per-cpu=4G</span>
<span style=color:#6272a4>#SBATCH --account=def-ksmccann</span>
<span style=color:#6272a4>#SBATCH --mail-user=kcazelle@uoguelph.ca</span>
<span style=color:#6272a4>#SBATCH --mail-type=FAIL</span>

julia -p <span style=color:#bd93f9>1</span> myscript.jl <span style=color:#8be9fd;font-style:italic>$SLURM_ARRAY_TASK_ID</span>
</code></pre></td></tr></table></div></div><p>relatively easy and very efficient! Note that when dealing with more than 5
parameters, the first two solutions might prove more tedious whereas you may
feel more confortable dealing with it in a programming language you know better.
For instance, it is likely that you would be able to create a function that
would generate the proper set of parameter based on a single parameter.
Alternatively, you could create an external file (may be with your favorite
programming langage) and then use <code>$SLURM_ARRAY_TASK_ID</code> to indicate the line of
the file to be read for a given simulation.</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>obviously, this should be installed first. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></div><div class=footer2><hr id=hr-footer align=left><div class=social-media-banner><a href=https://github.com/KevCaz><i class="fab fab fa-github-square"></i></a><a href=https://stackoverflow.com/users/8038778><i class="fab fa-stack-overflow"></i></a><a href=https://twitter.com/KCazelles><i class="fab fa-twitter-square"></i></a><a href=http://orcid.org/0000-0001-6619-9874><i class="ai ai-orcid-square"></i></a><a href="https://scholar.google.ca/citations?user=xzvcu7cAAAAJ%26hl"><i class="ai ai-google-scholar-square"></i></a><a href=https://www.researchgate.net/profile/Kevin_Cazelles><i class="ai ai-researchgate-square"></i></a><a href=https://kevcaz.github.io/index.xml><i class="fas fa-rss-square"></i></a></div><div class=footer-custom>Website built with <a href=https://gohugo.io/>Hugo</a>.<br><i class="fas fa-code"></i>available on <a href=https://github.com/KevCaz/KevCaz.github.io><i class="fab fa-github"></i></a>.<br>Content under <a href=https://creativecommons.org/publicdomain/zero/1.0><i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-zero"></i></a>unless otherwise specified.</div></div></div><div class=ctn-sidebar-secondary><div class=ctt-sidebar-secondary><h1><a href=#><i class="far fas fa-chevron-up"></i></a></h1><script src=../../../js/sidebar-secondary.js></script><h1><a onclick=scrollToBottom()><i class="far fas fa-chevron-down"></i></a></h1></div></div></div><script src=../../../js/sidebar-primary-dropdown.js></script><script>scrollingElement=(document.scrollingElement||document.body)
function scrollToBottom(){scrollingElement.scrollTop=scrollingElement.scrollHeight;}</script></body></html>